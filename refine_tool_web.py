import streamlit as st
import pandas as pd

# --------------------
# ç²¾ç…‰æˆæœ¬è³‡æ–™è¡¨
# --------------------
refine_data = [
    {"éšŽæ®µ": "+0~+1", "èµ·å§‹": 0, "ç¥žé‡‘æ•¸": 1, "è£å‚™ä»¶æ•¸": 0, "å®‰ç²¾è²»": 10000},
    {"éšŽæ®µ": "+1~+2", "èµ·å§‹": 1, "ç¥žé‡‘æ•¸": 1, "è£å‚™ä»¶æ•¸": 0, "å®‰ç²¾è²»": 20000},
    {"éšŽæ®µ": "+2~+3", "èµ·å§‹": 2, "ç¥žé‡‘æ•¸": 1, "è£å‚™ä»¶æ•¸": 0, "å®‰ç²¾è²»": 30000},
    {"éšŽæ®µ": "+3~+4", "èµ·å§‹": 3, "ç¥žé‡‘æ•¸": 1, "è£å‚™ä»¶æ•¸": 0, "å®‰ç²¾è²»": 40000},
    {"éšŽæ®µ": "+4~+5", "èµ·å§‹": 4, "ç¥žé‡‘æ•¸": 5, "è£å‚™ä»¶æ•¸": 1, "å®‰ç²¾è²»": 100000},
    {"éšŽæ®µ": "+5~+6", "èµ·å§‹": 5, "ç¥žé‡‘æ•¸": 10, "è£å‚™ä»¶æ•¸": 2, "å®‰ç²¾è²»": 220000},
    {"éšŽæ®µ": "+6~+7", "èµ·å§‹": 6, "ç¥žé‡‘æ•¸": 15, "è£å‚™ä»¶æ•¸": 3, "å®‰ç²¾è²»": 470000},
    {"éšŽæ®µ": "+7~+8", "èµ·å§‹": 7, "ç¥žé‡‘æ•¸": 25, "è£å‚™ä»¶æ•¸": 4, "å®‰ç²¾è²»": 910000},
    {"éšŽæ®µ": "+8~+9", "èµ·å§‹": 8, "ç¥žé‡‘æ•¸": 50, "è£å‚™ä»¶æ•¸": 6, "å®‰ç²¾è²»": 1630000},
    {"éšŽæ®µ": "+9~+10", "èµ·å§‹": 9, "ç¥žé‡‘æ•¸": 85, "è£å‚™ä»¶æ•¸": 10, "å®‰ç²¾è²»": 2740000},
    {"éšŽæ®µ": "+10~+11", "èµ·å§‹": 10, "ç¥žé‡‘æ•¸": 135, "è£å‚™ä»¶æ•¸": 22, "å®‰ç²¾è²»": 5250000},
    {"éšŽæ®µ": "+11~+12", "èµ·å§‹": 11, "ç¥žé‡‘æ•¸": 225, "è£å‚™ä»¶æ•¸": 30, "å®‰ç²¾è²»": 9000000},
    {"éšŽæ®µ": "+12~+13", "èµ·å§‹": 12, "ç¥žé‡‘æ•¸": 375, "è£å‚™ä»¶æ•¸": 45, "å®‰ç²¾è²»": 14500000},
    {"éšŽæ®µ": "+13~+14", "èµ·å§‹": 13, "ç¥žé‡‘æ•¸": 600, "è£å‚™ä»¶æ•¸": 69, "å®‰ç²¾è²»": 24500000},
    {"éšŽæ®µ": "+14~+15", "èµ·å§‹": 14, "ç¥žé‡‘æ•¸": 900, "è£å‚™ä»¶æ•¸": 98, "å®‰ç²¾è²»": 42000000},
]

df = pd.DataFrame(refine_data)

# --------------------
# Streamlit ä»‹é¢
# --------------------
st.set_page_config(page_title="ç²¾ç…‰æˆæœ¬å°å·¥å…·", page_icon="âš’ï¸")
st.title("âš’ï¸ ç²¾ç…‰æˆæœ¬è©¦ç®—å·¥å…·")

price_material = st.number_input("è«‹è¼¸å…¥ç¥žé‡‘åƒ¹æ ¼", value=69810)
price_equip = st.number_input("è«‹è¼¸å…¥è£å‚™åƒ¹æ ¼", value=100000)
start_level = st.number_input("èµ·å§‹ç­‰ç´š (0~14)", min_value=0, max_value=14, value=6)
end_level = st.number_input("ç›®æ¨™ç­‰ç´š (1~15)", min_value=1, max_value=15, value=15)

if st.button("â–¶ è¨ˆç®—æˆæœ¬"):
    selected = df[(df["èµ·å§‹"] >= start_level) & (df["èµ·å§‹"] < end_level)]

    total_metal = selected["ç¥žé‡‘æ•¸"].sum()
    total_equip = selected["è£å‚™ä»¶æ•¸"].sum()
    total_safety_cost = selected["å®‰ç²¾è²»"].sum()

    total_cost = total_metal * price_material + total_equip * price_equip + total_safety_cost

    st.subheader(f"âœ¨ ç²¾ç…‰è¨ˆç®—çµæžœï¼šå¾ž +{start_level} â†’ +{end_level}")
    st.write(f"ðŸ‘‰ éœ€è¦ç¥žé‡‘æ•¸é‡ï¼š{total_metal:,} å€‹")
    st.write(f"ðŸ‘‰ éœ€è¦è£å‚™ä»¶æ•¸ï¼š{total_equip:,} ä»¶")
    st.write(f"ðŸ‘‰ å®‰ç²¾è²»ç”¨åˆè¨ˆï¼š{total_safety_cost:,} Zeny")
    st.success(f"ðŸ’° ç¸½æˆæœ¬ï¼š{total_cost:,} Zeny")

    with st.expander("ðŸ“‹ æŸ¥çœ‹æ¯éšŽæ®µæ˜Žç´°"):
        st.dataframe(selected.reset_index(drop=True))
